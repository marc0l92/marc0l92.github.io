(this.webpackJsonpgw2trading=this.webpackJsonpgw2trading||[]).push([[0],{10:function(e){e.exports=JSON.parse('{"12159":{"price":0,"karma":35},"76839":{"price":56}}')},25:function(e,t,n){e.exports=n(50)},30:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(21),c=n.n(i),s=(n(30),n(3)),u=n(4),l=n(6),o=n(5),m=n(7),p=n(1),f=n.n(p),h=n(8),d=n(22),v=n(23),b=n.n(v),g="https://api.guildwars2.com/v2";function E(e){return y.apply(this,arguments)}function y(){return(y=Object(h.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get(g+t);case 2:if(n=e.sent,console.log(t,n),!n||200!==n.status){e.next=6;break}return e.abrupt("return",n.data);case 6:throw n;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=function(e){return E("/items/"+e)},j=function(e){return E("/recipes/"+e)},x=function(e){return Object(h.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",E("/recipes/search?output="+e));case 1:case"end":return t.stop()}}),t)})))()},w=function(e){return E("/commerce/listings/"+e)},k=n(10),N=new d.a("database");N.version(1).stores({items:"&id",recipes:"&id",recipesWithOutput:"&id",commerceListings:"&id"});var _=function(e){return Object(h.a)(f.a.mark((function t(){var n,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.items.where("id").equals(e).toArray();case 2:if(!((n=t.sent).length>0)){t.next=5;break}return t.abrupt("return",n[0]);case 5:return t.next=7,O(e);case 7:return a=t.sent,t.next=10,N.items.put(a);case 10:return t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)})))()},S=function(e){return Object(h.a)(f.a.mark((function t(){var n,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.recipes.where("id").equals(e).toArray();case 2:if(!((n=t.sent).length>0)){t.next=5;break}return t.abrupt("return",n[0]);case 5:return t.next=7,j(e);case 7:return a=t.sent,t.next=10,N.recipes.put(a);case 10:return t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)})))()},A=function(e){return Object(h.a)(f.a.mark((function t(){var n,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.recipesWithOutput.where("id").equals(e).toArray();case 2:if(!((n=t.sent).length>0)){t.next=5;break}return t.abrupt("return",n[0].value);case 5:return t.next=7,x(e);case 7:return a=t.sent,t.next=10,N.recipesWithOutput.put({id:e,value:a});case 10:return t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)})))()},q=function(e){return Object(h.a)(f.a.mark((function t(){var n,a,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.commerceListings.where("id").equals(e).toArray();case 2:if(!((n=t.sent).length>0&&(-1===n[0].timestamp||n[0].timestamp+3e5>Date.now()))){t.next=5;break}return t.abrupt("return",n[0]);case 5:if(!(e in k)){t.next=10;break}return a={id:e,sells:[{unit_price:k[e].price,quantity:99999}],timestamp:-1},t.next=9,N.commerceListings.put(a);case 9:return t.abrupt("return",a);case 10:return t.next=12,w(e);case 12:return r=t.sent,t.next=15,N.commerceListings.put(Object.assign(r,{timestamp:Date.now()}));case 15:return t.abrupt("return",r);case 16:case"end":return t.stop()}}),t)})))()},D=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={id:e.item,name:""},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;_(this.state.id).then((function(t){e.setState({name:t.name})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.id,a=t.name,i="list-group-item list-group-item-action"+(this.props.isActive?" active":""),c=a||"#"+n;return r.a.createElement("button",{type:"button",onClick:function(){return e.props.changeActive(n)},className:i,title:n},c)}}]),t}(a.Component),I=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("ul",{className:"list-group"},this.props.items.map((function(t){var n=t===e.props.activeItem;return r.a.createElement(D,{key:t,item:t,changeActive:e.props.changeActive,isActive:n})})))}}]),t}(a.Component),C=n(24);function L(e){if("number"!==typeof e)return r.a.createElement("span",null,e);var t=Math.floor(e/1e4);e%=1e4;var n=Math.floor(e/100);e%=100;var a=t?r.a.createElement("span",null,t," ",r.a.createElement("img",{alt:"Gold coin",src:"/images/Gold_coin.png",width:"15",height:"15"})):"",i=n?r.a.createElement("span",null,n," ",r.a.createElement("img",{alt:"Silver coin",src:"/images/Silver_coin.png",width:"15",height:"15"})):"",c=r.a.createElement("span",null,e," ",r.a.createElement("img",{alt:"Copper coin",src:"/images/Copper_coin.png",width:"15",height:"15"}));return r.a.createElement("span",null,a," ",i," ",c)}function M(e,t,n){var a=B(e);for(var r in n){var i=n[r].item_id,c=Math.floor(B(t[i])/n[r].count);c<a&&(a=c)}return a}function B(e){var t=0;for(var n in e)t+=e[n].quantity;return t}function W(e,t){for(var n=0,a=0;t>0&&a<e.length;){var r=Math.min(t,e[a].quantity);n+=e[a].unit_price*r,t-=r,a++}return n}var z=function(e){return Object(h.a)(f.a.mark((function t(){var n,a,r,i,c,s,u,l,o,m,p,h,d;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.ingredients,t.next=3,q(e.output_item_id);case 3:a=t.sent.buys,r={},t.t0=f.a.keys(n);case 6:if((t.t1=t.t0()).done){t.next=14;break}return i=t.t1.value,c=n[i].item_id,t.next=11,q(c);case 11:r[c]=t.sent.sells,t.next=6;break;case 14:for(s=M(a,r,n),u=0,l=.5,o=0;l>o&&u<s;){for(h in u++,m=W(a,u),p=0,n)d=n[h].item_id,p+=W(r[d],u*n[h].count);o=l,l=m-p}return t.abrupt("return",{quantity:u-1,profit:u>1?l:0});case 20:case"end":return t.stop()}}),t)})))()},G=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={ingredientsDetails:{},ingredientsListings:{},quantity:"NA",profit:"NA"},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.recipe.ingredients.map((function(t){return _(t.item_id).then((function(t){e.setState((function(e){var n=Object.assign({},e);return n.ingredientsDetails[t.id]=t,n}))})),q(t.item_id).then((function(t){e.setState((function(e){var n=Object.assign({},e);return n.ingredientsListings[t.id]=t,n}))})),t})),z(this.props.recipe).then((function(t){var n=t.quantity,a=t.profit;e.setState({quantity:n,profit:a})}))}},{key:"render",value:function(){var e=this.props.recipe,t=e.disciplines,n=e.ingredients,a=this.state,i=a.ingredientsDetails,c=a.ingredientsListings,s=a.quantity,u=a.profit;return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",null,"Disciplines:")," ",t.join(", ")),r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",null,"Quantity:")," ",s),r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",null,"Profit:")," ",L(u))),r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Count"),r.a.createElement("th",null,"BestInstantBuy"))),r.a.createElement("tbody",null,n.map((function(e){var t=e.item_id,n=i[t],a=c[t],s=r.a.createElement("td",null,"-");return a&&(s=r.a.createElement("td",null,L(a.sells[0].unit_price)," x ",a.sells[0].quantity)),r.a.createElement("tr",{key:t},r.a.createElement("td",null,t),r.a.createElement("td",null,n?n.name:"-"),r.a.createElement("td",null,e.count),s)})))))}}]),t}(a.Component),J=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={id:n.props.item,data:null,recipes:[]},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.retrieveDetails()}},{key:"render",value:function(){if(this.state.data&&this.state.listings){var e=this.state.data,t=e.id,n=e.name,a=e.flags,i=this.state.listings.buys[0];return r.a.createElement("div",null,r.a.createElement("h2",null,n),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("label",null,"Id:")," ",t),r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("label",null,"Flags:")," ",a.join(", ")),r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("label",null,"Best Instant Sell:")," ",L(i.unit_price)," x ",i.quantity)),r.a.createElement("h3",null,"Recipes"),this.state.recipes.map((function(e){return r.a.createElement(G,{key:e.id,recipe:e})})))}return r.a.createElement("div",null,r.a.createElement("h2",null,"Loading #",this.props.item,"..."))}},{key:"componentDidUpdate",value:function(e,t){e.item!==this.props.item&&this.retrieveDetails()}},{key:"retrieveDetails",value:function(){var e=this;_(this.props.item).then((function(t){e.setState({data:t})})),q(this.props.item).then((function(t){e.setState({listings:t})})),this.setState({recipes:[]},(function(){A(e.props.item).then((function(t){for(var n in t)S(t[n]).then((function(t){e.setState((function(e){return Object.assign({},e,{recipes:[].concat(Object(C.a)(e.recipes),[t])})}))}))}))}))}}]),t}(a.Component),F=[12178,12192,12209,62885,73034];localStorage.analyzed_items?F=localStorage.analyzed_items.split(","):localStorage.analyzed_items=F.join(",");var P=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(o.a)(t).call(this,e))).changeActive=function(e){n.setState({activeItem:e})},n.state={activeItem:F[0]},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.activeItem;return r.a.createElement("div",{className:"App"},r.a.createElement("nav",{className:"navbar navbar-light bg-light"},r.a.createElement("a",{className:"navbar-brand",href:"/"},"GW2 Trading")),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-3 overflow-auto"},r.a.createElement(I,{items:F,activeItem:e,changeActive:this.changeActive})),r.a.createElement("div",{className:"col-sm"},r.a.createElement(J,{item:e})))))}}]),t}(a.Component);c.a.render(r.a.createElement(P,null),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.4bb27e45.chunk.js.map